<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Access Controls (ACLs) &mdash; confidant 6.6.2-78f705 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="_static/css/confidant.css" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Server-blinded secrets" href="blind_secrets.html" />
    <link rel="prev" title="API" href="api.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="contents.html" class="icon icon-home">
            confidant
          </a>
              <div class="version">
                6.6.2-78f705
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Basics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="install.html#quickstart-for-testing">Quickstart for testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="install.html#docker-installation">Docker installation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="install.html#to-run-confidant-in-docker">To run confidant in Docker</a></li>
<li class="toctree-l3"><a class="reference internal" href="install.html#to-build-the-image">To build the image</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="install.html#pip-installation">pip installation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="install.html#make-a-virtualenv-and-install-pip-requirements">Make a virtualenv and install pip requirements</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="install.html#manual-installation">Manual installation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="install.html#clone-confidant">Clone Confidant</a></li>
<li class="toctree-l3"><a class="reference internal" href="install.html#id1">Make a virtualenv and install pip requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="install.html#build-the-frontend">Build the frontend</a></li>
<li class="toctree-l3"><a class="reference internal" href="install.html#run-confidant">Run confidant</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#docker-vs-bash">Docker vs bash</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#environment-configuration">Environment configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="configuration.html#gunicorn-configuration-for-ssl-termination-support">gunicorn configuration for SSL termination support</a></li>
<li class="toctree-l3"><a class="reference internal" href="configuration.html#google-authentication-configuration">Google authentication configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="configuration.html#saml-authentication-configuration">SAML authentication configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="configuration.html#user-authentication-session-settings">User authentication session settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="configuration.html#disabling-credential-conflict-checks">Disabling credential conflict checks</a></li>
<li class="toctree-l3"><a class="reference internal" href="configuration.html#statsd-metrics">statsd metrics</a></li>
<li class="toctree-l3"><a class="reference internal" href="configuration.html#sending-graphite-events">Sending graphite events</a></li>
<li class="toctree-l3"><a class="reference internal" href="configuration.html#google-authentication-user-restrictions">Google authentication user restrictions</a></li>
<li class="toctree-l3"><a class="reference internal" href="configuration.html#auth-token-lifetime">Auth token lifetime</a></li>
<li class="toctree-l3"><a class="reference internal" href="configuration.html#frontend-configuration">Frontend configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="configuration.html#development-and-testing-settings">Development and testing settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="configuration.html#bootstrapping-confidant-s-own-secrets">Bootstrapping Confidant’s own secrets</a></li>
<li class="toctree-l3"><a class="reference internal" href="configuration.html#multi-account-authentication">Multi-account authentication</a></li>
<li class="toctree-l3"><a class="reference internal" href="configuration.html#kms-authentication-for-end-users">KMS authentication for end-users</a></li>
<li class="toctree-l3"><a class="reference internal" href="configuration.html#kms-grant-management">KMS grant management</a></li>
<li class="toctree-l3"><a class="reference internal" href="configuration.html#confidant-client-configuration">Confidant client configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="configuration.html#maintenance-mode-settings">Maintenance mode settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="configuration.html#confidant-performance-settings">Confidant performance settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="configuration.html#certificate-authority-settings">Certificate Authority settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="configuration.html#settings-for-local-development">Settings for local development</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#kms-key-policy-configuration">KMS key policy configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#confidant-iam-role-configuration">Confidant IAM role configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#confidant-dynamodb-table-configuration">Confidant DynamoDB table configuration</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="using_confidant.html">Managing secrets and mappings</a><ul>
<li class="toctree-l2"><a class="reference internal" href="using_confidant.html#using-the-resources-view">Using the resources view</a><ul>
<li class="toctree-l3"><a class="reference internal" href="using_confidant.html#creating-secrets">Creating secrets</a></li>
<li class="toctree-l3"><a class="reference internal" href="using_confidant.html#mapping-secrets-to-services">Mapping secrets to services</a></li>
<li class="toctree-l3"><a class="reference internal" href="using_confidant.html#finding-credentials-and-services-in-the-sidebar">Finding credentials and services in the sidebar</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="using_confidant.html#using-the-history-view">Using the history view</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="client.html">Using the Confidant client</a><ul>
<li class="toctree-l2"><a class="reference internal" href="client.html#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="client.html#configuration">Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="client.html#usage">Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="client.html#reformatting-get-service-output">Reformatting get_service output</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Advanced</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="api.html">API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api.html#api-route-documentation">API route documentation</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Access Controls (ACLs)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#design">Design</a></li>
<li class="toctree-l2"><a class="reference internal" href="#acl-hookpoints">ACL Hookpoints</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#credentials">Credentials</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#list-credentials">List credentials</a></li>
<li class="toctree-l4"><a class="reference internal" href="#get-credential-metadata">Get credential metadata</a></li>
<li class="toctree-l4"><a class="reference internal" href="#get-credential">Get credential</a></li>
<li class="toctree-l4"><a class="reference internal" href="#create-credential">Create credential</a></li>
<li class="toctree-l4"><a class="reference internal" href="#update-credential">Update credential</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id1">Revert credential</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#services">Services</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#list-services">List services</a></li>
<li class="toctree-l4"><a class="reference internal" href="#get-service-metadata">Get service metadata</a></li>
<li class="toctree-l4"><a class="reference internal" href="#get-service">Get service</a></li>
<li class="toctree-l4"><a class="reference internal" href="#create-service">Create service</a></li>
<li class="toctree-l4"><a class="reference internal" href="#update-service">Update service</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id3">Revert service</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="blind_secrets.html">Server-blinded secrets</a><ul>
<li class="toctree-l2"><a class="reference internal" href="blind_secrets.html#what-are-server-blinded-secrets">What are server-blinded secrets?</a></li>
<li class="toctree-l2"><a class="reference internal" href="blind_secrets.html#kms-keys-and-iam-policy-examples-for-server-blinded-secrets">KMS keys and IAM policy examples for server-blinded secrets</a><ul>
<li class="toctree-l3"><a class="reference internal" href="blind_secrets.html#creating-and-updating-server-blinded-secrets-using-the-confidant-client">Creating and updating server-blinded secrets using the confidant client</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="kms_auth.html">KMS authentication</a><ul>
<li class="toctree-l2"><a class="reference internal" href="kms_auth.html#service-to-service-authentication">Service-to-service authentication</a><ul>
<li class="toctree-l3"><a class="reference internal" href="kms_auth.html#iam-policy-configuration-for-service-to-service-auth">IAM policy configuration for service-to-service auth</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="kms_auth.html#passing-encrypted-data-between-services">Passing encrypted data between services</a></li>
<li class="toctree-l2"><a class="reference internal" href="kms_auth.html#user-to-service-authentication">User-to-service authentication</a></li>
<li class="toctree-l2"><a class="reference internal" href="kms_auth.html#multi-account-kms-authentication">Multi-account KMS authentication</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="threat_model.html">Threat model</a><ul>
<li class="toctree-l2"><a class="reference internal" href="threat_model.html#web-client-threat-model">Web client threat model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="threat_model.html#assumptions">Assumptions</a></li>
<li class="toctree-l3"><a class="reference internal" href="threat_model.html#what-an-authenticated-user-can-achieve">What an authenticated user can achieve</a></li>
<li class="toctree-l3"><a class="reference internal" href="threat_model.html#what-compromise-of-an-authenticated-user-s-computer-can-achieve">What compromise of an authenticated user’s computer can achieve</a></li>
<li class="toctree-l3"><a class="reference internal" href="threat_model.html#what-an-unauthenticated-local-network-attacker-who-can-observe-network-traffic-can-achieve">What an unauthenticated local network attacker who can observe network traffic can achieve</a></li>
<li class="toctree-l3"><a class="reference internal" href="threat_model.html#what-an-unauthenticated-attacker-from-the-internet-can-achieve">What an unauthenticated attacker from the Internet can achieve</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="threat_model.html#web-server-threat-model">Web server threat model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="threat_model.html#id1">Assumptions</a></li>
<li class="toctree-l3"><a class="reference internal" href="threat_model.html#what-an-attacker-can-achieve-through-compromise-of-the-confidant-web-server">What an attacker can achieve through compromise of the Confidant web server</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="threat_model.html#service-client-threat-model">Service client threat model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="threat_model.html#id2">Assumptions</a></li>
<li class="toctree-l3"><a class="reference internal" href="threat_model.html#what-the-service-can-achieve">What the service can achieve</a></li>
<li class="toctree-l3"><a class="reference internal" href="threat_model.html#what-an-attacker-can-achieve-with-a-filesystem-read-vulnerability">What an attacker can achieve with a filesystem read vulnerability</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="threat_model.html#storage-threat-model">Storage threat model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="threat_model.html#id3">Assumptions</a></li>
<li class="toctree-l3"><a class="reference internal" href="threat_model.html#what-an-attacker-with-dynamodb-access-can-achieve">What an attacker with DynamoDB access can achieve</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="contributing.html#code-of-conduct">Code of conduct</a></li>
<li class="toctree-l2"><a class="reference internal" href="contributing.html#contributing-code">Contributing code</a><ul>
<li class="toctree-l3"><a class="reference internal" href="contributing.html#sign-the-contributor-license-agreement-cla">Sign the Contributor License Agreement (CLA)</a></li>
<li class="toctree-l3"><a class="reference internal" href="contributing.html#file-issues-in-github">File issues in Github</a></li>
<li class="toctree-l3"><a class="reference internal" href="contributing.html#submit-pull-requests">Submit pull requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="contributing.html#development-guide">Development guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="contributing.html#starting-confidant">Starting confidant</a></li>
<li class="toctree-l3"><a class="reference internal" href="contributing.html#running-tests">Running tests</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="data_schema.html">DynamoDB Data Schema</a><ul>
<li class="toctree-l2"><a class="reference internal" href="data_schema.html#at-rest-encryption-model">At-rest encryption model</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="maintenance.html">Maintenance</a><ul>
<li class="toctree-l2"><a class="reference internal" href="maintenance.html#permanantly-archiving-disabled-credentials-to-a-separate-dynamodb-table">Permanantly archiving disabled credentials to a separate DynamoDB table</a></li>
<li class="toctree-l2"><a class="reference internal" href="maintenance.html#restoring-archived-credentials-back-into-the-primary-dynamodb-table">Restoring archived credentials back into the primary DynamoDB table</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="upgrade.html">Upgrading</a><ul>
<li class="toctree-l2"><a class="reference internal" href="upgrade.html#upgrading-to-2-0-0-or-3-0-0">Upgrading to 2.0.0 or 3.0.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="upgrade.html#performing-the-data-migration">Performing the data migration</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="upgrade.html#upgrading-to-4-0-0">Upgrading to 4.0.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="upgrade.html#peforming-the-data-migration-for-4-0-0">Peforming the data migration for 4.0.0</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a><ul>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#id1">6.6.2</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#id2">6.6.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#id3">6.5.8</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#id4">6.4.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#id5">6.3.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#id6">6.2.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#id7">6.1.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#id8">6.0.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#id9">5.2.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#id10">5.1.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#id11">5.0.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#id12">5.0.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#id13">4.4.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#id14">4.3.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#id15">4.3.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#id16">4.2.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#id17">4.1.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#id18">4.0.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#id19">3.0.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#id20">2.0.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#id21">2.0.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#id22">1.11.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#id23">1.10.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#id24">1.10.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#id25">1.9.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="changelog.html#id26">1.8.0</a></li>
<li class="toctree-l3"><a class="reference internal" href="changelog.html#id27">1.7.0</a></li>
<li class="toctree-l3"><a class="reference internal" href="changelog.html#id28">1.6.0</a></li>
<li class="toctree-l3"><a class="reference internal" href="changelog.html#id29">1.5.1</a></li>
<li class="toctree-l3"><a class="reference internal" href="changelog.html#id30">1.5.0</a></li>
<li class="toctree-l3"><a class="reference internal" href="changelog.html#id31">1.4.0</a></li>
<li class="toctree-l3"><a class="reference internal" href="changelog.html#id32">1.3.0</a></li>
<li class="toctree-l3"><a class="reference internal" href="changelog.html#id33">1.2.0</a></li>
<li class="toctree-l3"><a class="reference internal" href="changelog.html#id34">1.1.21</a></li>
<li class="toctree-l3"><a class="reference internal" href="changelog.html#id35">1.1.20</a></li>
<li class="toctree-l3"><a class="reference internal" href="changelog.html#id36">1.1.19</a></li>
<li class="toctree-l3"><a class="reference internal" href="changelog.html#id37">1.1.16 - 1.1.18</a></li>
<li class="toctree-l3"><a class="reference internal" href="changelog.html#id38">1.1.15</a></li>
<li class="toctree-l3"><a class="reference internal" href="changelog.html#id39">1.1.14</a></li>
<li class="toctree-l3"><a class="reference internal" href="changelog.html#id40">1.1.13</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Communication</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="support.html">Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="security_reporting.html">Reporting security vulnerabilities</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="contents.html">confidant</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="contents.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Access Controls (ACLs)</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/acls.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="access-controls-acls">
<h1>Access Controls (ACLs)<a class="headerlink" href="#access-controls-acls" title="Permalink to this heading">¶</a></h1>
<section id="design">
<h2>Design<a class="headerlink" href="#design" title="Permalink to this heading">¶</a></h2>
<p>The design for managing fine-grained ACLs in confidant is relatively simple. Hookpoints are called whenever a resource type will be accessed by an end-user; these hookpoints look like:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">check</span> <span class="o">=</span> <span class="n">acl_module_check</span><span class="p">(</span>
    <span class="n">resource_type</span><span class="o">=</span><span class="s1">&#39;credential&#39;</span><span class="p">,</span>
    <span class="n">action</span><span class="o">=</span><span class="s1">&#39;metadata&#39;</span><span class="p">,</span>
    <span class="n">resource_id</span><span class="o">=</span><span class="nb">id</span><span class="p">,</span>
<span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">check</span><span class="p">:</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>Some hookpoints include extra information, via kwargs:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">check</span> <span class="o">=</span> <span class="n">acl_module_check</span><span class="p">(</span>
    <span class="n">resource_type</span><span class="o">=</span><span class="s1">&#39;service&#39;</span><span class="p">,</span>
    <span class="n">action</span><span class="o">=</span><span class="s1">&#39;update&#39;</span><span class="p">,</span>
    <span class="n">resource_id</span><span class="o">=</span><span class="nb">id</span><span class="p">,</span>
    <span class="n">kwargs</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;credential_ids&#39;</span><span class="p">:</span> <span class="n">combined_cred_ids</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">check</span><span class="p">:</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>These hookpoints all call back to the same function, which by default is:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">default_acl</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Default ACLs for confidant: always return true for users, but enforce</span>
<span class="sd">    ACLs for services, restricting access to:</span>
<span class="sd">    * resource_type: service</span>
<span class="sd">      actions: metadata, get</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">resource_type</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;resource_type&#39;</span><span class="p">)</span>
    <span class="n">action</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;action&#39;</span><span class="p">)</span>
    <span class="n">resource_id</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;resource_id&#39;</span><span class="p">)</span>
    <span class="c1"># Some ACL checks also pass extra args in via kwargs, which we would</span>
    <span class="c1"># access via:</span>
    <span class="c1">#    resource_kwargs = kwargs.get(&#39;kwargs&#39;)</span>
    <span class="k">if</span> <span class="n">authnz</span><span class="o">.</span><span class="n">user_is_user_type</span><span class="p">(</span><span class="s1">&#39;user&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">elif</span> <span class="n">authnz</span><span class="o">.</span><span class="n">user_is_user_type</span><span class="p">(</span><span class="s1">&#39;service&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">resource_type</span> <span class="o">==</span> <span class="s1">&#39;service&#39;</span> <span class="ow">and</span> <span class="n">action</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;metadata&#39;</span><span class="p">,</span> <span class="s1">&#39;get&#39;</span><span class="p">]:</span>
            <span class="c1"># Does the resource ID match the authenticated username?</span>
            <span class="k">if</span> <span class="n">authnz</span><span class="o">.</span><span class="n">user_is_service</span><span class="p">(</span><span class="n">resource_id</span><span class="p">):</span>
                <span class="k">return</span> <span class="kc">True</span>
        <span class="c1"># We currently only allow services to access service get/metadata</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># This should never happen, but paranoia wins out</span>
        <span class="k">return</span> <span class="kc">False</span>
</pre></div>
</div>
<p>This function is defined by the <code class="docutils literal notranslate"><span class="pre">ACL_MODULE</span></code> setting, which by default is <code class="docutils literal notranslate"><span class="pre">confidant.authnz.rbac:default_acl</span></code>. The format is <code class="docutils literal notranslate"><span class="pre">python.path.to.module:function_in_module</span></code>. You can use this to implement an ACL approach that integrates with your own enviroment, or adjusts confidant’s behavior to your needs.</p>
<p>When implementing a new ACL module, remember that there’s two types of users: <code class="docutils literal notranslate"><span class="pre">user</span></code> and <code class="docutils literal notranslate"><span class="pre">service</span></code>. By default <code class="docutils literal notranslate"><span class="pre">service</span></code> users are through kmsauth, whereas <code class="docutils literal notranslate"><span class="pre">user</span></code> users can come through kmsauth, or through one of the other forms of auth intended for the UI. You need to implement ACLs for both user types. Additionally, you should likely default your return to False, unless you’re intending to only restrict features.</p>
</section>
<section id="acl-hookpoints">
<h2>ACL Hookpoints<a class="headerlink" href="#acl-hookpoints" title="Permalink to this heading">¶</a></h2>
<p>The following hookpoints are currently available:</p>
<section id="credentials">
<h3>Credentials<a class="headerlink" href="#credentials" title="Permalink to this heading">¶</a></h3>
<section id="list-credentials">
<h4>List credentials<a class="headerlink" href="#list-credentials" title="Permalink to this heading">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">acl_module_check</span><span class="p">(</span><span class="n">resource_type</span><span class="o">=</span><span class="s1">&#39;credential&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;list&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>This check controls access to lists of credential metadata.</p>
</section>
<section id="get-credential-metadata">
<h4>Get credential metadata<a class="headerlink" href="#get-credential-metadata" title="Permalink to this heading">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">acl_module_check</span><span class="p">(</span>
    <span class="n">resource_type</span><span class="o">=</span><span class="s1">&#39;credential&#39;</span><span class="p">,</span>
    <span class="n">action</span><span class="o">=</span><span class="s1">&#39;metadata&#39;</span><span class="p">,</span>
    <span class="n">resource_id</span><span class="o">=</span><span class="nb">id</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>This check controls access to specific credential metadata, which does not include credential pairs. Fine-grained controls can be applied using the provided <code class="docutils literal notranslate"><span class="pre">resource_id</span></code>.</p>
</section>
<section id="get-credential">
<h4>Get credential<a class="headerlink" href="#get-credential" title="Permalink to this heading">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">acl_module_check</span><span class="p">(</span>
    <span class="n">resource_type</span><span class="o">=</span><span class="s1">&#39;credential&#39;</span><span class="p">,</span>
    <span class="n">action</span><span class="o">=</span><span class="s1">&#39;get&#39;</span><span class="p">,</span>
    <span class="n">resource_id</span><span class="o">=</span><span class="nb">id</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>This check controls access to specific credentials, which includes credential pairs. Fine-grained controls can be applied using the provided <code class="docutils literal notranslate"><span class="pre">resource_id</span></code>.</p>
</section>
<section id="create-credential">
<h4>Create credential<a class="headerlink" href="#create-credential" title="Permalink to this heading">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">acl_module_check</span><span class="p">(</span>
    <span class="n">resource_type</span><span class="o">=</span><span class="s1">&#39;credential&#39;</span><span class="p">,</span>
    <span class="n">action</span><span class="o">=</span><span class="s1">&#39;create&#39;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>This check controls create access to credentials. This is a global permission, so no fine-grained ID is provided.</p>
</section>
<section id="update-credential">
<h4>Update credential<a class="headerlink" href="#update-credential" title="Permalink to this heading">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">acl_module_check</span><span class="p">(</span>
    <span class="n">resource_type</span><span class="o">=</span><span class="s1">&#39;credential&#39;</span><span class="p">,</span>
    <span class="n">action</span><span class="o">=</span><span class="s1">&#39;update&#39;</span><span class="p">,</span>
    <span class="n">resource_id</span><span class="o">=</span><span class="nb">id</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>This check controls update access to specific credentials. Fine-grained controls can be applied using the provided <code class="docutils literal notranslate"><span class="pre">resource_id</span></code>. Note that if you’re controlling access to this, you probably also want to control access to <a class="reference external" href="#revert-credential">Revert credential</a>.</p>
</section>
<section id="id1">
<h4>Revert credential<a class="headerlink" href="#id1" title="Permalink to this heading">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">acl_module_check</span><span class="p">(</span>
    <span class="n">resource_type</span><span class="o">=</span><span class="s1">&#39;credential&#39;</span><span class="p">,</span>
    <span class="n">action</span><span class="o">=</span><span class="s1">&#39;revert&#39;</span><span class="p">,</span>
    <span class="n">resource_id</span><span class="o">=</span><span class="nb">id</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>This check controls revert access to specific credentials. Fine-grained controls can be applied using the provided <code class="docutils literal notranslate"><span class="pre">resource_id</span></code>. Note that if you’re controlling access to this, you probably also want to control access to <a class="reference external" href="#update-credential">Update credential</a>.</p>
<p>This action does not require access to view or edit credential pairs, so it can be used to allow folks to rollback changes to resources without access to view/edit them.</p>
</section>
</section>
<section id="services">
<h3>Services<a class="headerlink" href="#services" title="Permalink to this heading">¶</a></h3>
<section id="list-services">
<h4>List services<a class="headerlink" href="#list-services" title="Permalink to this heading">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">acl_module_check</span><span class="p">(</span><span class="n">resource_type</span><span class="o">=</span><span class="s1">&#39;service&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;list&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>This check controls access to lists of service metadata.</p>
</section>
<section id="get-service-metadata">
<h4>Get service metadata<a class="headerlink" href="#get-service-metadata" title="Permalink to this heading">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">acl_module_check</span><span class="p">(</span>
    <span class="n">resource_type</span><span class="o">=</span><span class="s1">&#39;service&#39;</span><span class="p">,</span>
    <span class="n">action</span><span class="o">=</span><span class="s1">&#39;metadata&#39;</span><span class="p">,</span>
    <span class="n">resource_id</span><span class="o">=</span><span class="nb">id</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>This check controls access to specific service metadata, which includes service data, and credential metadata, for credentials that are mapped to the service, but does not include credential pairs in the credentials. Fine-grained controls can be applied using the provided <code class="docutils literal notranslate"><span class="pre">resource_id</span></code>.</p>
</section>
<section id="get-service">
<h4>Get service<a class="headerlink" href="#get-service" title="Permalink to this heading">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">acl_module_check</span><span class="p">(</span>
    <span class="n">resource_type</span><span class="o">=</span><span class="s1">&#39;service&#39;</span><span class="p">,</span>
    <span class="n">action</span><span class="o">=</span><span class="s1">&#39;get&#39;</span><span class="p">,</span>
    <span class="n">resource_id</span><span class="o">=</span><span class="nb">id</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>This check controls access to specific service data, which includes service data, and credential that are mapped to the service, including credential pairs in the credentials. Fine-grained controls can be applied using the provided <code class="docutils literal notranslate"><span class="pre">resource_id</span></code>.</p>
</section>
<section id="create-service">
<h4>Create service<a class="headerlink" href="#create-service" title="Permalink to this heading">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">acl_module_check</span><span class="p">(</span>
    <span class="n">resource_type</span><span class="o">=</span><span class="s1">&#39;service&#39;</span><span class="p">,</span>
    <span class="n">action</span><span class="o">=</span><span class="s1">&#39;create&#39;</span><span class="p">,</span>
    <span class="n">resource_id</span><span class="o">=</span><span class="nb">id</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>This check controls create access to specific services. Fine-grained controls can be applied using the provided <code class="docutils literal notranslate"><span class="pre">resource_id</span></code>.</p>
</section>
<section id="update-service">
<h4>Update service<a class="headerlink" href="#update-service" title="Permalink to this heading">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">acl_module_check</span><span class="p">(</span>
    <span class="n">resource_type</span><span class="o">=</span><span class="s1">&#39;service&#39;</span><span class="p">,</span>
    <span class="n">action</span><span class="o">=</span><span class="s1">&#39;update&#39;</span><span class="p">,</span>
    <span class="n">resource_id</span><span class="o">=</span><span class="nb">id</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>This check controls update access to specific services. Fine-grained controls can be applied using the provided <code class="docutils literal notranslate"><span class="pre">resource_id</span></code>. Note that if you’re controlling access to this, you probably also want to control access to <a class="reference external" href="#revert-service">Revert service</a>.</p>
</section>
<section id="id3">
<h4>Revert service<a class="headerlink" href="#id3" title="Permalink to this heading">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">acl_module_check</span><span class="p">(</span>
    <span class="n">resource_type</span><span class="o">=</span><span class="s1">&#39;service&#39;</span><span class="p">,</span>
    <span class="n">action</span><span class="o">=</span><span class="s1">&#39;revert&#39;</span><span class="p">,</span>
    <span class="n">resource_id</span><span class="o">=</span><span class="nb">id</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>This check controls revert access to specific services. Fine-grained controls can be applied using the provided <code class="docutils literal notranslate"><span class="pre">resource_id</span></code>. Note that if you’re controlling access to this, you probably also want to control access to <a class="reference external" href="#update-service">Update service</a>.</p>
<p>This action does not require access to view or update services, so it can be used to allow folks to rollback changes to resources without access to view/update them.</p>
</section>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="api.html" class="btn btn-neutral float-left" title="API" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="blind_secrets.html" class="btn btn-neutral float-right" title="Server-blinded secrets" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019-2024, Confidant Project Authors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>